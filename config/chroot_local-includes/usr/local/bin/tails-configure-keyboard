#!/bin/sh

set -eu

# Get $XKBMODEL, $XKBLAYOUT, $XKBVARIANT and $XKBOPTIONS
. /var/lib/tails-user-session/keyboard

if [ -z $XKBVARIANT ] ; then
	XKBCONF=$XKBLAYOUT
else
	XKBCONF=$XKBLAYOUT+$XKBVARIANT
fi

dconf write /org/gnome/desktop/input-sources/sources "[('xkb', '$XKBCONF'), ('xkb', 'us')]"
dconf write /org/gnome/desktop/input-sources/xkb-options "$XKBOPTIONS"
